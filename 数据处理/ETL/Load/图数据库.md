# 图数据库

### 节点建立

- (:Actor)
- (:Director)
- (:Movie)
  - 新添加一个字段：review_num，表示这部电影总的评论数量

### 关系建立

- (:Actor)-[:ACTED]->(:Movie)：演员参演了哪些电影
- (:Director)-[:DIRECT]->(:Movie)：导演执导了哪些电影

### 合作关系查询

#### 经常合作的演员

```cypher
MATCH (a1:Actor)-[:ACTED]->(:Movie)<-[:ACTED]-(a2:Actor)
WHERE ID(a1) < ID(a2)
RETURN a1.actor_name, a2.actor_name, COUNT(*) AS collaboration_count
ORDER BY collaboration_count DESC
```

#### 经常合作的导演和演员

```cypher
MATCH (a:Actor)-[:ACTED]->(:Movie)<-[:ACTED]-(a2:Actor),
      (d:Director)-[:DIRECT]->(:Movie)<-[:ACTED]-(a:Actor)
RETURN a.actor_name, d.director_name, COUNT(*) AS collaboration_count
ORDER BY collaboration_count DESC
```

#### 某类型下评论最多的导演组合

```cypher
MATCH (a:Actor)-[:ACTED]->(m:Movie)
RETURN a.actor_name, sum(m.revie_num) AS review_count
ORDER BY review_count DESC
```

