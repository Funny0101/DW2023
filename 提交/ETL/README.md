# ETL脚本说明

### 1 数据爬取

`movie_crawl.py`用于爬取网页

### 2 数据处理

1. `handle_reviews.py`用于处理电影评论集
   - 抽取电影ID
   - 提取电影的最早评论时间
   - 计算电影的评论数并添加到movie表等
2. `merge_movies.py`用于对爬取到的电影信息进行处理
   - 清除错误字符（引号等）
   - 去除标题中的版本信息
   - 电影去重等操作
3. `merge_names.py`用于合并同一姓名的表现形式
   - 去除引号
   - 提取所有姓名至pkl文件
   - 使用模糊匹配找到对应关系
   - 根据对应关系进行更改为统一形式
4. `supplementary.py`主要用于做一些补充的操作
   - 将评论最早时间作为电影上映时间
   - 提取需要存储到图数据库的信息，比如导演名、演员名、电影id、电影名称、电影类型、电影评论数量等
   - 建立导演和电影间的执导关系以及演员和电影间的演出关系
   - 建立电影与被替换电影之间的ID映射关系